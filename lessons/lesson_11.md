# Занятие 11

## Теоретическая часть

 - Что такое документоориентированные (noSQL) БД  
 - В чем их преимущество  
 - В каких случаях стоит использовать документоориентированную БД  
 - В каких случаях не стоит использовать документоориентированную БД  
 - mongodb как наиболее популярное решение в качестве документоориентированной БД  
 - mongoose как ODM к mongodb  

 - схема данных и система дефолтов  
 - валидация  
 - сабдокументы 
 - populate  
 - хуки  
 - статические свойства  
 - виртуальные методы  


## Практическая часть

### Установка mongodb

Устанавливать монгу будем через docker:
```bash
docker pull mongo:latest
```

Запуск контейнера осуществляется командой:
```bash
docker run -d
  --net=host \
  --name mongo \
  -v /home/username/project/data/:/data/db \
  -v /home/username/project/log/mongo:/var/log/mongodb \
  mongo
```
(не забываем про то, что данные, которые пишутся внутри контейнера превратятся
в тыкву после того, как контейнер умрет, поэтому монтируем ему каталоги для хранения данных)  

### GUI для работы с mongo
 * [Robomongo](https://robomongo.org/)

Устанавливаем mongoose
```bash
npm i --save mongoose
```

Далее действуем по официальной [документации](https://mongoosejs.com)  

### Задание 1
Заменить основное хранилище с mariadb на mongodb.
Перед началом изменений обязательно нужно создать ветку,
в которой останется нетронутым код работы с mariadb (см. git checkout -b).
Далее нужно:
 - написать код подключения к БД  
 - описать схему данных пользователей  
 - поправить роуты, чтобы они использовали mongoose-модели  
 - проверить, что весь функционал работает  

### Задание 2
# TODO магазин - не самый лучший вариант под mongo
нужно подумать о чем-то другом

Написать небольшой интернет-магазин для продажи книг.
В этом задании будет только часть по добавлению книг на сервер.
**Добавлять книги может только пользователь с правами администратора.**
У книги есть следующие атрибуты:
 - название
 - автор
 - описание
 - жанр

Должно быть реализованно:
* Добавление
* Выборка (поиск по автору и названию книги)
* Редактирование существующей книги
* Можно сменить жанр книги
* Можно добавить, удалить автора


## Homework


## Ссылки/Литература
 - [Официальная документация к mongodb](https://docs.mongodb.com)  
 - [Официальная документация к mongoose](https://mongoosejs.com)  
 - [Грабли mongoose](https://habrahabr.ru/post/253395)  